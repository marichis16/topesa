<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  <script src="https://www.gstatic.com/firebasejs/5.4.1/firebase.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
    crossorigin="anonymous">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1"
    crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../CSS/paginas.css">

</head>
<style>
  /* Set the size of the div element that contains the map */
  #map {
    height: 400px;
    /* The height is 400 pixels */
    width: 100%;
    /* The width is the width of the web page */
  }
</style>
<SCRIPT>
  var map;
  var marker_inicio;
  var marker_fin;

</SCRIPT>

<body class="container">

  <nav class="navbar navbar-expand-lg navbar-light bg-dark">
    <div class="container-fluid">
        <ul class="nav navbar-nav">
            <li class="nav-item active">
                <a class="nav-link" id="nbar" href="../main.html">
                    <img src="../images/home.png" width="20" height="20" id="nbarImgMenu" class="d-inline-block" alt="">
                    Menú
                </a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" id="nbar" href="./pantallaEmpleados.html">Empleados</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" id="nbar" href="./pantallaVehiculos.html">Vehículos</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" id="nbar" href="./pantallaClientes.html">Clientes</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" id="nbarAct" href="./pantallaVisitas.html">Visitas<span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item active">
              <a class="nav-link" id="nbar" href="./pantallaLocalizaciones.html">Localizaciones</a>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li class="nav-item active">
                <button class="btn btn-dark" id="nbarLink" onclick="logOut()">
                  <img src="../images/user.png" width="18" height="18" class="d-inline-block align-top" alt="">
                  Cerrar Sesión</button>
            </li>
        </ul>
      </div>
  </nav>

  <h1 id="titulos">Visitas</h1>
  <div class="row">

    <script>
      // Initialize and add the map
      function initMap() {
        // The location of Uluru
        var lugar_inicio = {
          lat: -0.001,
          lng: -78.67
        };
        var lugar_fin = {
          lat: 0.002,
          lng: -78.5647
        };

        // The map, centered at Uluru
          map = new google.maps.Map(
          document.getElementById('map'), {
            zoom: 10,
            center: lugar_inicio
          });
        // The marker, positioned at Uluru
        /*marker_inicio = new google.maps.Marker({
          position: lugar_inicio,
          map: map
        });
        marker_fin = new google.maps.Marker({
          position: lugar_fin,
          map: map
        });*/

      }
    </script>
    <!--Load the API from the specified URL
    * The async attribute allows the browser to render the page while the API loads
    * The key parameter will contain your own API key (which is not needed for this tutorial)
    * The callback parameter executes the initMap() function
    -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBkE9yLDd6MTlzMlx-kZBmHkQIern8kZHM&callback=initMap">
    </script>
  </div>

  <div class="row">


    <div class="col-sm-10" id="tabla">
      <table class="table" id="myTable">
        <thead>
          <tr>
            <th>#</th>
            <th>Empleado</th>
            <th>Cliente</th>
            <th>Fecha</th>
            <th>Inicio</th>
            <th>Fin</th>
            <th>Observación</th>
            <th>Imagen</th>
           <!-- <th>Ubicación Inicio</th>
            <th>Ubicación Fin</th>-->
            <th>Ubicación</th>

          </tr>
        </thead>
      </table>
    </div>
  </div>
  <button  class="btn-info" onclick="generateexcel('myTable')">Exportar Excel</button>


  <!--script para que funcione el mapa de google -->
  <h3>MAPA</h3>
  <!--The div element for the map -->
  <div id="map"></div>
  <script src="../js/visitas.js">
  </script>
<script>
function fnExcelReport(idTable)
{
    var tab_text=" <table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById(idTable); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+  encodeHTML(tab.rows[j].innerHTML)+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    console.log("texto tabla");
    console.log(tab_text);
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}

function generateexcel(tableid) {
 // $(tableid+' tr').find('td:eq(7),th:eq(7)').remove();
  var table= document.getElementById(tableid);
  var html = table.outerHTML;

  //add more symbols if needed...
  
  while (html.indexOf('á') != -1) html = html.replace('á', '&aacute;');
  while (html.indexOf('é') != -1) html = html.replace('é', '&eacute;');
  while (html.indexOf('í') != -1) html = html.replace('í', '&iacute;');
  while (html.indexOf('ó') != -1) html = html.replace('ó', '&oacute;');
  while (html.indexOf('ú') != -1) html = html.replace('ú', '&uacute;');
  while (html.indexOf('º') != -1) html = html.replace('º', '&ordm;');
  while (html.indexOf('ñ') != -1) html = html.replace('º', '&ntilde;');

  window.open('data:application/vnd.ms-excel,' + encodeURIComponent(html));
}


function encodeHTML(str){
 var aStr = str.split(''),
     i = aStr.length,
     aRet = [];

   while (--i) {
    var iC = aStr[i].charCodeAt();
    if (iC < 65 || iC > 127 || (iC>90 && iC<97)) {
      aRet.push('&#'+iC+';');
    } else {
      aRet.push(aStr[i]);
    }
  }
 return aRet.reverse().join('');
}

</script>

</body>

</html>